# PodsToSPMConverter ‚Äì Advanced Guide

This repository vendors third‚Äëparty dependencies as Swift Packages into the `Vendor/` folder and generates a lightweight shell package (`Shell/`) that aggregates them for consumption by your app. It is designed to work entirely offline after the first run by converting remote binary targets to path‚Äëbased dependencies and by mirroring transitive package sources locally.

## Overview
- Converts remote `.binaryTarget(url: ...)` targets to local `path:` XCFrameworks.
- Mirrors transitive SwiftPM dependencies locally and rewrites manifests to path‚Äëbased `package(path:)` entries.
- Generates a single shell package (`Shell/`) that re‚Äëexports modules you use, so your app can simply `import ThirdPartyShell`.
- Supports authenticated and anonymous binary hosts (GitHub Releases, Artifactory/JFrog, S3 redirects, etc.).

## Quick Start
1. Adjust the configuration in `vendor_config.normalized.json` (names, versions, products).
2. Run vendoring:
   ```bash
   python3 build_shell_from_json.py --force
   ```
3. In Xcode, add `Shell/` as a local Swift Package and build.

## Useful Flags
- `--force` ‚Äì reprocesses packages even if they were previously completed.
- `--package Name[,Name2]` ‚Äì process only specific packages (fast iterative workflow).
- `--include-unsupported` ‚Äì include packages marked `spmSupported: false` in the config.

## Authentication & Hosts
Some hosts require specific headers or flows. The script auto‚Äëdetects many common cases and also honors optional per‚Äëpackage `binaryHeaders` from the config.

- GitHub Releases API assets
  - Accepts `GITHUB_TOKEN`/`GH_TOKEN` env for rate‚Äëlimit friendly downloads.
  - Uses `Accept: application/octet-stream` for asset endpoints.
- Artifactory / JFrog
  - Anonymous downloads via the documented Download API:
    - `GET /artifactory/api/download/{repoKey}/{path}?useRedirect=true`
  - Storage API fallback to resolve `downloadUri` for direct download.
  - Env‚Äëbased authentication (optional):
    - `ARTIFACTORY_API_KEY` / `APPD_ARTIFACTORY_API_KEY`
    - `ARTIFACTORY_ACCESS_TOKEN` / `APPD_ARTIFACTORY_ACCESS_TOKEN`
    - `ARTIFACTORY_USER` + `ARTIFACTORY_PASSWORD` or `ARTIFACTORY_BASIC_AUTH`

## Caching & Clean Builds
- Xcode ‚Üí File ‚Üí Packages ‚Üí Reset Package Caches.
- Product ‚Üí Clean Build Folder.
- CLI:
  ```bash
  (cd Shell && swift package reset && swift package resolve)
  ```
- Delete `~/Library/Developer/Xcode/DerivedData/Shell*/SourcePackages` if a stale artifact pops up.

## Troubleshooting Tips
- ‚ÄúNo such module ‚ÄòX‚Äô‚Äù after converting binaries: reset caches so Xcode picks up the new path‚Äëbased manifest.
- Slow clones: the script uses shallow fetches, tag‚Äëfirst lookups, LFS smudge disabled, and cleans `.git` metadata after finishing.
- Path vs product names: SwiftPM lets you depend on ‚Äúproducts‚Äù, but you import ‚Äúmodules‚Äù (targets). The shell re‚Äëexports the actual modules so `import ThirdPartyShell` works.

---

## Vendored Packages ‚Äì Live Matrix
The table below is generated by the script after each run.

<!-- BEGIN VENDOR MATRIX -->
Last updated: `2025-08-29T08:53:28Z`

| Package | Version | Clone | Binaries | Remaining | Errors |
|---|---:|:---:|---:|---:|---|
| abseil-cpp-swiftpm | 0.20200225.4 | [33mSKIP[0m | 0 | 0 |  |
| AEPAnalytics | 4.0.0 | [33mSKIP[0m | 0 | 0 |  |
| AEPAssurance | 4.1.1 | [33mSKIP[0m | 0 | 0 |  |
| AEPCore | 4.2.4 | [33mSKIP[0m | 0 | 0 |  |
| AEPEdge | 4.3.1 | [33mSKIP[0m | 0 | 0 |  |
| AEPEdgeConsent | 4.0.0 | [33mSKIP[0m | 0 | 0 |  |
| AEPEdgeIdentity | 4.0.0 | [33mSKIP[0m | 0 | 0 |  |
| AEPRulesEngine | 4.0.0 | [33mSKIP[0m | 0 | 0 |  |
| AEPTarget | 4.0.3 | [33mSKIP[0m | 0 | 0 |  |
| Alamofire | 5.0.0 | [33mSKIP[0m | 0 | 0 |  |
| AlamofireNetworkActivityLogger | 3.4.0 | [33mSKIP[0m | 0 | 0 |  |
| AppDynamicsAgent | 2023.10.1 | [33mSKIP[0m | 0 | 0 |  |
| BigInt | 5.2.0 | [33mSKIP[0m | 0 | 0 |  |
| boringssl-swiftpm | 0.7.2 | [33mSKIP[0m | 0 | 0 |  |
| collectionconcurrencykit | 0.2.0 | [33mSKIP[0m | 0 | 0 |  |
| CryptoSwift | 1.4.1 | [33mSKIP[0m | 0 | 0 |  |
| DeviceKit | 5.5.0 | [33mSKIP[0m | 0 | 0 |  |
| DGCharts | 5.0.0 | [33mSKIP[0m | 0 | 0 |  |
| Firebase | 8.9.1 | [33mSKIP[0m | 0 | 0 |  |
| FloatingPanel | 2.8.1 | [33mSKIP[0m | 0 | 0 |  |
| googleappmeasurement | 8.9.1 | [33mSKIP[0m | 0 | 0 |  |
| GoogleDataTransport | 9.1.2 | [33mSKIP[0m | 0 | 0 |  |
| GoogleMaps | 8.3.1 | [33mSKIP[0m | 0 | 0 |  |
| GooglePlaces | 8.3.0 | [33mSKIP[0m | 0 | 0 |  |
| googleutilities | 7.13.3 | [33mSKIP[0m | 0 | 0 |  |
| grpc-swiftpm | 1.28.4 | [33mSKIP[0m | 0 | 0 |  |
| gtm-session-fetcher | 1.7.2 | [33mSKIP[0m | 0 | 0 |  |
| Insider | 1.4.1 | [33mSKIP[0m | 0 | 0 |  |
| IOSSecuritySuite | 2.0.2 | [33mSKIP[0m | 0 | 0 |  |
| iProov | 11.1.1 | [33mSKIP[0m | 0 | 0 |  |
| IQKeyboardManagerSwift | 6.3.0 | [33mSKIP[0m | 0 | 0 |  |
| ISPageControl | 0.1.0 | [33mSKIP[0m | 0 | 0 |  |
| KeychainAccess | 3.2.1 | [33mSKIP[0m | 0 | 0 |  |
| Kingfisher | 7.9.1 | [33mSKIP[0m | 0 | 0 |  |
| leveldb | 1.22.5 | [33mSKIP[0m | 0 | 0 |  |
| Lottie | 4.5.0 | [33mSKIP[0m | 0 | 0 |  |
| Mantis | 2.8.0 | [33mSKIP[0m | 0 | 0 |  |
| MEPSDK | 9.8.6 | [33mSKIP[0m | 0 | 0 |  |
| MGSwipeTableCell | 1.6.14 | [33mSKIP[0m | 0 | 0 |  |
| nanopb | 0.3.9.8 | [33mSKIP[0m | 0 | 0 |  |
| Promises | 2.0.0 | [33mSKIP[0m | 0 | 0 |  |
| RxDataSources | 5.0.0 | [33mSKIP[0m | 0 | 0 |  |
| RxKeyboard | 2.0.0 | [33mSKIP[0m | 0 | 0 |  |
| RxSwift | 6.6.0 | [33mSKIP[0m | 0 | 0 |  |
| RxSwiftExt | 6.2.1 | [33mSKIP[0m | 0 | 0 |  |
| SkeletonView | 1.30.1 | [33mSKIP[0m | 0 | 0 |  |
| sourcekitten | 0.33.1 | [33mSKIP[0m | 0 | 0 |  |
| SVProgressHUD | 2.3.1 | [33mSKIP[0m | 0 | 0 |  |
| swift-argument-parser | 1.2.3 | [33mSKIP[0m | 0 | 0 |  |
| swift-protobuf | 1.31.0 | [33mSKIP[0m | 0 | 0 |  |
| swift-syntax | HEAD | [33mSKIP[0m | 0 | 0 |  |
| SwiftLint | 0.50.1 | [33mSKIP[0m | 0 | 0 |  |
| swiftytexttable | 0.9.0 | [33mSKIP[0m | 0 | 0 |  |
| swxmlhash | 7.0.2 | [33mSKIP[0m | 0 | 0 |  |
| TensorFlowLiteC | 2.14.0 | [33mSKIP[0m | 0 | 0 |  |
| yams | 5.4.0 | [33mSKIP[0m | 0 | 0 |  |
| ZIPFoundation | 0.9.19 | [33mSKIP[0m | 0 | 0 |  |
<!-- END VENDOR MATRIX -->


---

## Configuration Notes
- To keep a package vendor‚Äëonly (vendored locally but not added to the shell target), set its `products` to an empty list in `vendor_config.normalized.json`.
- For packages that need post‚Äëclone tweaks (e.g., move files, bump platform), add a `postCloneCommands` array with shell snippets. Commands run inside the package directory.

## License
See individual package licenses in `Vendor/<Package>/` and this repository‚Äôs license.

